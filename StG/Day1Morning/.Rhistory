{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
hist(Type)
hist(Type)
hist(Type)
hist(Type)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
hist(Type)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
mat=matrix(0, nrow=length(s), ncol=2)
x1=X[X[,2]==i, ]
x1
range(x1)
range(x1[,1])
length(which(x1[,1]>5))
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
mat=matrix(0, nrow=length(s), ncol=2)
for(i in 1:length(s))
{
x1=X[X[,2]==i, ]
c1=length(which(x1[1,] > 0))
mat[i,1] = nrow(x1)-length(idx)
mat[i,2] = length(idx)
}
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
mat=matrix(0, nrow=length(s), ncol=2)
for(i in 1:length(s))
{
x1=X[X[,2]==i, ]
c1=length(which(x1[1,] > 0))
mat[i,1] = nrow(x1)-c1
mat[i,2] = c1
}
mat
x1
c1
which(x1[1,]>0)
x1
which(x1[1,]>0)
head(x1)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
mat=matrix(0, nrow=length(s), ncol=2)
for(i in 1:length(s))
{
x1=X[X[,2]==i, ]
c1=length(which(x1[,1] > 0))
mat[i,1] = nrow(x1)-c1
mat[i,2] = c1
}
mat
barplot(x1)
barplot(t(x1))
barplot(t(mat))
layout(matrix(1:2, 2, 1))
barplot(t(mat))
barplot(s)
layout(matrix(1:2, 2, 1))
barplot(t(-1mat))
barplot(s)
layout(matrix(1:2, 2, 1))
barplot(s)
barplot(t(-1*mat))
layout(matrix(1:2, 2, 1))
barplot(varContri)
barplot(t(-1*mat))
barplot(t(-1*mat), border = F)
layout(matrix(1:2, 2, 1))
barplot(varContri)
barplot(t(-1*mat), border = F)
par(mai=c(0, 0.5, 0.5, 0))
layout(matrix(1:2, 2, 1))
par(mai=c(0, 0.5, 0.5, 0))
barplot(varContri)
par(mai=c(0.5, 0.5, 0, 0))
barplot(t(-1*mat), border = F)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
mat=matrix(0, nrow=length(s), ncol=2)
for(i in 1:length(s))
{
x1=X[X[,2]==i, ]
c1=length(which(x1[,1] > 0))
mat[i,1] = nrow(x1)-c1
mat[i,2] = c1
}
layout(matrix(1:2, 2, 1))
par(mai=c(0, 0.5, 0.5, 0))
barplot(varContri, border = F)
par(mai=c(0.5, 0.5, 0, 0))
barplot(t(-1*mat), border = F)
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
mat=matrix(0, nrow=length(s), ncol=2)
for(i in 1:length(s))
{
x1=X[X[,2]==i, ]
c1=length(which(x1[,1] > 0))
mat[i,1] = nrow(x1)-c1
mat[i,2] = c1
}
layout(matrix(1:2, 2, 1))
par(mai=c(0, 0.5, 0.5, 0))
barplot(varContri, border = F)
par(mai=c(0.5, 0.5, 0, 0))
barplot(t(-1*mat), border = F, col=c("yellow", "blue"))
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
mat=matrix(0, nrow=length(s), ncol=2)
for(i in 1:length(s))
{
x1=X[X[,2]==i, ]
c1=length(which(x1[,1] > 0))
mat[i,1] = nrow(x1)-c1
mat[i,2] = c1
}
layout(matrix(1:2, 2, 1))
par(mai=c(0, 0.5, 0.5, 0))
barplot(varContri, border = F, ylab="% variation")
par(mai=c(0.5, 0.5, 0, 0))
barplot(t(-1*mat), border = F, col=c("yellow", "blue"))
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
mat=matrix(0, nrow=length(s), ncol=2)
for(i in 1:length(s))
{
x1=X[X[,2]==i, ]
c1=length(which(x1[,1] > 0))
mat[i,1] = nrow(x1)-c1
mat[i,2] = c1
}
layout(matrix(1:2, 2, 1))
par(mai=c(0, 1, 0.5, 0))
barplot(varContri, border = F, ylab="% variation")
par(mai=c(0.5, 1, 0, 0))
barplot(t(-1*mat), border = F, col=c("yellow", "blue"))
n=1000
EV=scale(rnorm(n))
Type=floor(runif(n, 1, 8)+0.5)
X=matrix(c(scale(EV), Type), n, 2)
s=array(0, dim=length(table(Type)))
for(i in 1:length(s))
{
s[i]=sum(X[X[,2]==i, 1]^2)
}
varContri=s/sum(s)
print(varContri)
mat=matrix(0, nrow=length(s), ncol=2)
for(i in 1:length(s))
{
x1=X[X[,2]==i, ]
c1=length(which(x1[,1] > 0))
mat[i,1] = nrow(x1)-c1
mat[i,2] = c1
}
layout(matrix(1:2, 2, 1))
par(mai=c(0.2, 1, 0.5, 0))
barplot(varContri, border = F, ylab="% variation")
par(mai=c(0.5, 1, 0.2, 0))
barplot(t(-1*mat), border = F, col=c("yellow", "blue"))
install.packages("Rtools")
install.packages("Rtools")
install.packages("~/manuscript/EigenGWAS/EigenGWAS_Package/EigenGWASFriends_0.1.0.tar.gz", type-"source", repos=NULL)
install.packages("~/manuscript/EigenGWAS/EigenGWAS_Package/EigenGWASFriends_0.1.0.tar.gz", type="source", repos=NULL)
library(EigenGWASFriends)
data(tt)
tt
install.packages("~/git/EigenGWASFriends_0.1.0.tar.gz", repos = NULL, type = "source")
library(EigenGWASFriends)
help("read.table")
install.packages("~/git/EigenGWASFriends_0.1.0.tar.gz", repos = NULL, type = "source")
install.packages("~/git/EigenGWASFriends_0.1.0.tar.gz", repos = NULL, type = "source")
library(EigenGWASFriends)
detach("package:EigenGWASFriends", unload=TRUE)
library("EigenGWASFriends", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
install.packages("~/git/proQC_0.1.0.tar.gz", repos = NULL, type = "source")
qchisq(1.6e-148,1)
qchisq(1.6e-148,1, lower.tail = F)
qchisq(1.65e-149,1, lower.tail = F)
install.packages("~/git/EigenGWASFriends_0.1.0.tar.gz", repos = NULL, type = "source")
library("OATH", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
detach("package:OATH", unload=TRUE)
detach("package:methods", unload=TRUE)
library("EigenGWASFriends", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
qchisq(1.65e-149, 1, lower.tail = F)
pnorm(40)
pnorm(20)
pnorm(10)
pnorm(5)
pnorm(3)
pnorm(2)
pnorm(2.1)
pnorm(5)
pnorm(8)
install.packages("~/git/EigenGWASFriends_0.1.0.tar.gz", repos = NULL, type = "source")
library(EigenGWASFriends)
help(aim)
library("MultiPhen", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
setwd("~/git/Notes/StG/Day1Morning")
ceu=read.table("../HM/ceu_22_1k")
setwd("~/git/Notes/StG/Day1Morning")
ceu=read.plink("../HM/ceu_22_1k")
dim(ceu)
ceu=read.table("../HM/ceu_r.ped", as.is = T)
dim(ceu)
ceu[1:8,1:8]
ceu=read.table("../HM/ceu_r.raw", as.is = T)
dim(ceu)
ceu[1:5, 1:5]
ceu=read.table("../HM/ceu_r.raw", as.is = T, header = T)
ceu[1:5, 1:9]
cceu=cor(ceu[,-c(1:6)])
dim(cceu)
heatmap(cceu, Colv = NA, Rowv = NA)
chb=read.table("../HM/chb_r.raw", as.is = T, header = T)
cchb=cor(chb[,-c(1:6)])
chb[1:5, 1:8]
yri=read.table("../HM/yri_r.raw", as.is = T, header = T)
cyri=cor(yri[,-c(1:6)])
ceu=read.table("../HM/ceu_r.raw", as.is = T, header = T)
cceu=cor(ceu[,-c(1:6)])
heatmap(cceu, Colv = NA, Rowv = NA, labRow = NA, labCol = NA, col=topo.colors(32, 0.3))
heatmap(cchb, Colv = NA, Rowv = NA, labRow = NA, labCol = NA, col=topo.colors(32, 0.3))
heatmap(cyri, Colv = NA, Rowv = NA, labRow = NA, labCol = NA, col=topo.colors(32, 0.3))
ceufq=read.table("../HM/ceu_22.frq", as.is = T, header = T)
chbfq=read.table("../HM/chb_22.frq", as.is = T, header = T)
yrifq=read.table("../HM/yri_22.frq", as.is = T, header = T)
layout(1:3, 3, 1)
hist(ceufq$MAF)
layout(1:3, 1, 3)
hist(ceufq$MAF)
layout(matrix(1:3, 1, 3))
hist(ceufq$MAF)
hist(chbfq$MAF)
hist(yrifq$MAF)
layout(matrix(1:3, 1, 3))
hist(ceufq$MAF, xlab="CEU", main = "CEU MAF CHR 22")
hist(chbfq$MAF, xlab="CHB", main = "CHB MAF CHR 22")
hist(yrifq$MAF, xlab="YRI", main = "YRI MAF CHR 22")
##############hapmap genome
ceuGfq=read.table("../HM/ceu.frq", as.is = T, header = T)
chbGfq=read.table("../HM/chb.frq", as.is = T, header = T)
yriGfq=read.table("../HM/yri.frq", as.is = T, header = T)
layout(matrix(1:3, 1, 3))
hist(ceuGfq$MAF, xlab="CEU", main = "CEU MAF")
hist(chbGfq$MAF, xlab="CHB", main = "CHB MAF")
hist(yriGfq$MAF, xlab="YRI", main = "YRI MAF")
ceuGfq=read.table("../HM/ceu.frq", as.is = T, header = T)
ceuGfq=read.table("../HM/ceu_fq.frq", as.is = T, header = T)
chbGfq=read.table("../HM/chb_fq.frq", as.is = T, header = T)
yriGfq=read.table("../HM/yri_fq.frq", as.is = T, header = T)
layout(matrix(1:3, 1, 3))
hist(ceuGfq$MAF, xlab="CEU", main = "CEU MAF")
hist(chbGfq$MAF, xlab="CHB", main = "CHB MAF")
hist(yriGfq$MAF, xlab="YRI", main = "YRI MAF")
layout(matrix(1:3, 1, 3))
hist(ceuGfq$MAF, xlab="CEU", main = "CEU MAF", breaks = 50)
hist(chbGfq$MAF, xlab="CHB", main = "CHB MAF", breaks = 50)
hist(yriGfq$MAF, xlab="YRI", main = "YRI MAF", breaks = 50)
