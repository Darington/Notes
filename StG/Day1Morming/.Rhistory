freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv)
##########################
##########################
#sample size
N=1000
M=2000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv)
##########################
##########################
#sample size
N=1000
M=2000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv)
##########################
##########################
#sample size
N=1000
M=2000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv)
##########################
##########################
#sample size
N=1000
M=2000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv, breaks=50)
##########################
##########################
#sample size
N=1000
M=2000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv, breaks=50)
##########################
##########################
#sample size
N=1000
M=2000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv, breaks=50)
##########################
##########################
#sample size
N=1000
M=2000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv, breaks=50)
##########################
##########################
#sample size
N=1000
M=2000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv, breaks=50)
##########################
##########################
#sample size
N=1000
M=20000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv, breaks=50)
##########################
##########################
#sample size
N=1000
M=20000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv, breaks=50)
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
hist(pv)
help(rbinom)
pv=pbinom(freqDat, N, 0.5)
hist(pv)
pv
pbinom(freqDat[1], 10, 0.5)
pbinom(freqDat[1], N, 0.5)
pbinom(0.5, 2, 0.5)
pbinom(0.5, 1, 0.5)
pv=pbinom(apply(gmat, 2, sum), 2*N, 0.5)
hist(pv)
##########################
##########################
#sample size
N=1000
M=20000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
pv=pbinom(apply(gmat, 2, sum), 2*N, 0.5)
hist(pv)
##########################
##########################
#sample size
N=1000
M=20000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
pv=pbinom(apply(gmat, 2, sum), 2*N, 0.5)
hist(pv)
hist(pv, breaks = 50)
apply(gmat, 2, sum)
N
hist(pv, breaks = 50)
##########################
##########################
#sample size
N=1000
M=20000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
pv=pbinom(apply(gmat, 2, sum), 2*N, 0.5)
hist(pv, breaks = 50)
##########################
##########################
#sample size
N=1000
M=20000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
pv=pbinom(apply(gmat, 2, sum), 2*N, 0.5)
hist(pv, breaks = 50)
##########################
##########################
#sample size
N=1000
M=200000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
pv=pbinom(apply(gmat, 2, sum), 2*N, 0.5)
hist(pv, breaks = 50)
hist(pv)
##########################
##########################
#sample size
N=1000
M=200000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:3, 1, 3))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pv=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
pv=pbinom(apply(gmat, 2, sum), 2*N, 0.5)
hist(pv)
##########################
##########################
#sample size
N=1000
M=200000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:4, 2, 2))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pvN=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
pvB=pbinom(apply(gmat, 2, sum), 2*N, 0.5)
hist(pvN)
hist(pvB)
##########################
##########################
#sample size
N=1000
M=20000
#uniform
freq=runif(M)
#0.5
freq=rep(0.5, M)
#
gmat=matrix(0, N, M)
for(i in 1:M)
{
gmat[,i] = rbinom(N, 2, freq[i])
}
layout(matrix(1:4, 2, 2))
freqDat=colMeans(gmat)/2
plot(freqDat, frame.plot = F, xlab="Locus", ylab="Freq")
qqplot(freqDat, rnorm(M, freq, sqrt(freq*(1-freq)/(2*N))), xlab = "Observed", ylab="Expected", frame.plot=F)
abline(a=0, b=1, col="red")
pvN=pnorm((freqDat-0.5)/sqrt(freqDat*(1-freqDat)/(2*N)))
pvB=pbinom(apply(gmat, 2, sum), 2*N, 0.5)
hist(pvN)
hist(pvB)
####################
####Gold Standard
##########p-value
layout(matrix(1:2, 2, 1))
N=c(500, 500, 500)
tS=rt(N[1], df=2)
chiS=rchisq(N[2], df=2)
normS=rnorm(N[3], mean=20)
hist(tS, xlim=c(-10, 30), main="3 distribution")
hist(chiS, add=T, col="red")
hist(normS, add=T, col="blue")
hist(c(pt(tS, df = 2), pchisq(chiS, df=2), pnorm(normS, mean=20)), main="p-value", xlab="P-value")
##########p-value, different df, mu
layout(matrix(1:2, 2, 1))
N=c(500, 500, 500)
dft=runif(N[1], 2, 10)
tS=rt(N[1], df=dft)
dfchi=runif(N[2], 1, 8)
chiS=rchisq(N[2], df=dfchi)
muN=runif(N[3], 10, 20)
normS=rnorm(N[3], mean=muN)
hist(tS, xlim=c(-10, 30), main="3 distribution")
hist(chiS, add=T, col="red")
hist(normS, add=T, col="blue")
hist(c(pt(tS, df = dft), pchisq(chiS, df=dfchi), pnorm(normS, mean=muN)), main="p-value", xlab="P-value")
layout(matrix(1:4, 2, 2))
N=c(500, 500, 500)
tS=rt(N[1], df=2)
chiS=rchisq(N[2], df=2)
normS=rnorm(N[3], mean=20)
hist(tS, xlim=c(-10, 30), main="3 distribution")
hist(chiS, add=T, col="red")
hist(normS, add=T, col="blue")
hist(c(pt(tS, df = 2), pchisq(chiS, df=2), pnorm(normS, mean=20)), main="p-value", xlab="P-value")
##########p-value, different df, mu
N=c(500, 500, 500)
dft=runif(N[1], 2, 10)
tS=rt(N[1], df=dft)
dfchi=runif(N[2], 1, 8)
chiS=rchisq(N[2], df=dfchi)
muN=runif(N[3], 10, 20)
normS=rnorm(N[3], mean=muN)
hist(tS, xlim=c(-10, 30), main="3 distribution")
hist(chiS, add=T, col="red")
hist(normS, add=T, col="blue")
hist(c(pt(tS, df = dft), pchisq(chiS, df=dfchi), pnorm(normS, mean=muN)), main="p-value", xlab="P-value")
####################
####Gold Standard
##########p-value
layout(matrix(1:4, 2, 2))
N=c(500, 500, 500)
tS=rt(N[1], df=2)
chiS=rchisq(N[2], df=2)
normS=rnorm(N[3], mean=20)
hist(tS, xlim=c(-10, 30), main="3 distribution")
hist(chiS, add=T, col="red")
hist(normS, add=T, col="blue")
hist(c(pt(tS, df = 2), pchisq(chiS, df=2), pnorm(normS, mean=20)), main="p-value", xlab="P-value")
##########p-value, different df, mu
N=c(500, 500, 500)
dft=runif(N[1], 2, 10)
tS=rt(N[1], df=dft)
dfchi=runif(N[2], 1, 8)
chiS=rchisq(N[2], df=dfchi)
muN=runif(N[3], 10, 20)
normS=rnorm(N[3], mean=muN)
hist(tS, xlim=c(-10, 30), main="3 distribution (various df, mu)")
hist(chiS, add=T, col="red")
hist(normS, add=T, col="blue")
hist(c(pt(tS, df = dft), pchisq(chiS, df=dfchi), pnorm(normS, mean=muN)), main="p-value", xlab="P-value")
