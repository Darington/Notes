M2=matrix(c(0.25, 0.5, 0.5, 1), 2, 2)
CV=t(B) %*% Ia %*% (M1+M2) %*% Ia %*% B
CV
fq=c(0.5, 0.25)
B=matrix(c(1,1), 2, 1)
Ia=matrix(c(sqrt(2*fq[1]*(1-fq[1])), 0, 0, sqrt(2*fq[2]*fq[2])), 2, 2, byrow = T)
M1=matrix(c(1, 0.5, 0.5, 0.25), 2, 2)
M2=matrix(c(0.25, 0.5, 0.5, 1), 2, 2)
CV=t(B) %*% Ia %*% (M1+M2) %*% Ia %*% B
CV
source("~/R/MyLib/shotgun.R")
View(Dprime2LD)
dpp=Dprime2Correlation(fq, dp)
dp=c(0.5)
dpp=Dprime2Correlation(fq, dp)
dpp
View(Dprime2Correlation)
dp=c(1)
dpp=Dprime2Correlation(fq, dp)
dpp
source("~/R/MyLib/shotgun.R")
fq=c(0.5, 0.25)
dp=c(1)
dpp=Dprime2Correlation(fq, dp)
B=matrix(c(1,1), 2, 1)
Ia=matrix(c(sqrt(2*fq[1]*(1-fq[1])), 0, 0, sqrt(2*fq[2]*fq[2])), 2, 2, byrow = T)
M1=matrix(c(1, 0.5, 0.5, 0.25), 2, 2)
M2=matrix(c(0.25, 0.5, 0.5, 1), 2, 2)
CV=t(B) %*% Ia %*% (M1+M2) %*% Ia %*% B
CV
source("~/R/MyLib/shotgun.R")
fq=c(0.5, 0.25)
dp=c(-0.5)
dpp=Dprime2Correlation(fq, dp)
B=matrix(c(1,1), 2, 1)
Ia=matrix(c(sqrt(2*fq[1]*(1-fq[1])), 0, 0, sqrt(2*fq[2]*fq[2])), 2, 2, byrow = T)
M1=matrix(c(1, 0.5, 0.5, 0.25), 2, 2)
M2=matrix(c(0.25, 0.5, 0.5, 1), 2, 2)
CV=t(B) %*% Ia %*% (M1+M2) %*% Ia %*% B
CV
dpp
source("~/R/MyLib/shotgun.R")
fq=c(0.5, 0.25)
dp=c(0.5)
dpp=Dprime2Correlation(fq, dp)
B=matrix(c(1,1), 2, 1)
Ia=matrix(c(sqrt(2*fq[1]*(1-fq[1])), 0, 0, sqrt(2*fq[2]*fq[2])), 2, 2, byrow = T)
M1=matrix(c(1, 0.5, 0.5, 0.25), 2, 2)
M2=matrix(c(0.25, 0.5, 0.5, 1), 2, 2)
CV=t(B) %*% Ia %*% (M1+M2) %*% Ia %*% B
dpp
source("~/R/MyLib/shotgun.R")
fq=c(0.5, 0.25)
dp=c(0.5)
dpp=Dprime2Correlation(fq, dp)
B=matrix(c(1,1), 2, 1)
Ia=matrix(c(sqrt(2*fq[1]*(1-fq[1])), 0, 0, sqrt(2*fq[2]*fq[2])), 2, 2, byrow = T)
M1=matrix(c(1, dpp, dpp, dpp^2), 2, 2)
M2=matrix(c(dpp^2, dpp, dpp, 1), 2, 2)
CV=t(B) %*% Ia %*% (M1+M2) %*% Ia %*% B
CV
dm=matrix(c(1, dpp^2, dpp^2, 1), 2, 2)
dm
CV/dm
mean(dm)
CV/mean(dm)
source("~/R/MyLib/shotgun.R")
fq=c(0.5, 0.25)
dp=c(0.5)
dpp=Dprime2Correlation(fq, dp)
B=matrix(c(1,1), 2, 1)
Ia=matrix(c(sqrt(2*fq[1]*(1-fq[1])), 0, 0, sqrt(2*fq[2]*fq[2])), 2, 2, byrow = T)
M1=matrix(c(1, dpp, dpp, dpp^2), 2, 2)
M2=matrix(c(dpp^2, dpp, dpp, 1), 2, 2)
CV=t(B) %*% Ia %*% (M1+M2) %*% Ia %*% B
dm=matrix(c(1, dpp^2, dpp^2, 1), 2, 2)
vg=B[1,1]^2*2*fq[1]*(1-fq[1]) + B[2, 1]^2 *2 * fq[1]*(1-fq[1])
vg
vg=B[1,1]^2*2*fq[1]*(1-fq[1]) + B[2, 1]^2 *2 * fq[1]*(1-fq[1]) + 2*dpp * sqrt(2 * fq[1]*(1-fq[1]) * 2 * fq[2]*(1-fq[2])) * B[1,1] * B[2,1]
vg
source("~/R/MyLib/shotgun.R")
fq=c(0.5, 0.25)
dp=c(0.5)
dpp=Dprime2Correlation(fq, dp)
B=matrix(c(1,1), 2, 1)
Ia=matrix(c(sqrt(2*fq[1]*(1-fq[1])), 0, 0, sqrt(2*fq[2]*fq[2])), 2, 2, byrow = T)
M1=matrix(c(1, dpp, dpp, dpp^2), 2, 2)
M2=matrix(c(dpp^2, dpp, dpp, 1), 2, 2)
CV=t(B) %*% Ia %*% (M1+M2) %*% Ia %*% B
dm=matrix(c(1, dpp^2, dpp^2, 1), 2, 2)
he=CV/mean(dm)*2
vg=B[1,1]^2*2*fq[1]*(1-fq[1]) + B[2, 1]^2 *2 * fq[1]*(1-fq[1]) + 2*dpp * sqrt(2 * fq[1]*(1-fq[1]) * 2 * fq[2]*(1-fq[2])) * B[1,1] * B[2,1]
h2
he
vg
he=2*CV/sum(dm)
he
vg
source("~/R/MyLib/shotgun.R")
fq=c(0.5, 0.5)
dp=c(0)
dpp=Dprime2Correlation(fq, dp)
B=matrix(c(1,1), 2, 1)
Ia=matrix(c(sqrt(2*fq[1]*(1-fq[1])), 0, 0, sqrt(2*fq[2]*fq[2])), 2, 2, byrow = T)
M1=matrix(c(1, dpp, dpp, dpp^2), 2, 2)
M2=matrix(c(dpp^2, dpp, dpp, 1), 2, 2)
CV=t(B) %*% Ia %*% (M1+M2) %*% Ia %*% B
dm=matrix(c(1, dpp^2, dpp^2, 1), 2, 2)
he=2*CV/sum(dm)
vg=B[1,1]^2*2*fq[1]*(1-fq[1]) + B[2, 1]^2 *2 * fq[1]*(1-fq[1]) + 2*dpp * sqrt(2 * fq[1]*(1-fq[1]) * 2 * fq[2]*(1-fq[2])) * B[1,1] * B[2,1]
vg
he
f2=rbinom(400, 2, 0.5)
f2
dcode=ifelse(f2 == 0, 0, ifelse(f2==1), 1, 0)
dcode=ifelse(f2 == 0, 0, ifelse(f2==1, 1, 0))
dcode
head(f2)
head(f2)
plot(f2, dcode)
y=matrix(rnorm(N*100), N, 100)
N=400
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, 0, ifelse(f2==1, 1, 0))
y=matrix(rnorm(N*100), N, 100)
i=1
md=lm(y[,i]~dcode)
md
summary(md)
summary(md)
summary(md)$coefficients
N=400
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, 0, ifelse(f2==1, 1, 0))
y=matrix(rnorm(N*100), N, 100)
beta=matrix(0, 100, 4)
for(i in 1:100)
{
md=lm(y[,i]~dcode)
beta[i,] = summary(md)$coefficients[2,]
}
hist(beta[,4])
N=400
RP=10000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, 0, ifelse(f2==1, 1, 0))
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 4)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,] = summary(md)$coefficients[2,]
}
N=400
REP=10000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, 0, ifelse(f2==1, 1, 0))
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 4)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,] = summary(md)$coefficients[2,]
}
hist(beta[,4])
N=400
REP=2000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, 0, ifelse(f2==1, 1, 0))
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 4)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,] = summary(md)$coefficients[2,]
}
plot(beta[,2])
plot(beta[,4])
hist(beta[,4])
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, 0, ifelse(f2==1, 1, 0))
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 4)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,] = summary(md)$coefficients[2,]
}
hist(beta[,4])
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
plot(f2, dcode)
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 4)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,] = summary(md)$coefficients[2,]
}
hist(beta[,4])
md
summary(md)
summary(md)
names(summary(md))
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,1:4] = summary(md)$coefficients[2,]
beta[i, 5] = summary(md)$fstatistic
}
hist(beta[,4])
summary(md)$fstatistic
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,1:4] = summary(md)$coefficients[2,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,4])
hist(beta[,5])
summary(md)
summary(md)$fstatistic
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,1:4] = summary(md)$coefficients[2,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,4])
summary(md)
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode+0.5
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,1:4] = summary(md)$coefficients[2,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,4])
summary(md)
pf(2.23, 1, 398)
pf(2.23, 1, 398, lower.tail = F)
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode+0.5
y=matrix(rnorm(N*REP), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode)
beta[i,1:4] = summary(md)$coefficients[2,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,4])
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode+0.5
y=matrix(rnorm(N*REP,1), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode-1)
beta[i,1:4] = summary(md)$coefficients[2,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,4])
help(lm)
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode+0.5
y=matrix(rnorm(N*REP,1), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode - 1)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,4])
md
head(f2)
head(dcode)
hist(beta[,1])
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode
y=matrix(rnorm(N*REP,1), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode - 1)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,4])
hist(beta[,1])
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode+0.5
y=matrix(rnorm(N*REP,1), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode - 1)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,4])
hist(beta[,1])
var(dcode)
N=400
REP=5000
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode
y=matrix(rnorm(N*REP,1), N, REP)
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
md=lm(y[,i]~dcode - 1)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
mean(beta[,1])
hist(beta[,4])
N=400
REP=5000
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode - 1)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
setwd("~/StatGenet/Day2Morming")
N=400
REP=5000
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode - 1)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
head(beta)
hist(beta[,4])
N=400
REP=5000
layout(matrix(1:4, 2,2))
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode - 1)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
hist(beta[,4])
#####
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode+0.5
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode - 1)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
hist(beta[,4])
N=400
REP=5000
#######wrong model
layout(matrix(1:4, 2,2))
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode - 1) #no mean
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
hist(beta[,4])
#####
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode+0.5
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode-1)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
hist(beta[,4])
##########right model
layout(matrix(1:4, 2,2))
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
hist(beta[,4])
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode+0.5
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode)
beta[i,1:4] = summary(md)$coefficients[1,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
hist(beta[,4])
layout(matrix(1:4, 2,2))
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode)
beta[i,1:4] = summary(md)$coefficients[2,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
hist(beta[,4])
beta=matrix(0, REP, 5)
for(i in 1:REP)
{
f2=rbinom(N, 2, 0.5)
dcode=ifelse(f2 == 0, -0.5, ifelse(f2==1, 0.5, -0.5))
dcode=dcode+0.5
y=matrix(rnorm(N,1), N, 1)
md=lm(y[,1]~dcode)
beta[i,1:4] = summary(md)$coefficients[2,]
beta[i, 5] = summary(md)$fstatistic[1]
}
hist(beta[,1])
hist(beta[,4])
